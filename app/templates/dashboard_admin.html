{% extends "base.html" %}

{% block content %}
<div class="container my-5">
    <h1 class="text-center mb-4">Dashboard</h1>

    <!-- Statistics Section -->
    <div class="row text-center mb-5">
        <div class="col-md-3">
            <div class="card bg-info text-white" onclick="loadTickets('total')">
                <div class="card-body">
                    <h5 class="card-title">Total Tickets</h5>
                    <p class="card-text display-4">{{ total_tickets }}</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-success text-white" onclick="loadTickets('open')">
                <div class="card-body">
                    <h5 class="card-title">Open Tickets</h5>
                    <p class="card-text display-4">{{ open_tickets }}</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-warning text-dark" onclick="loadTickets('in_progress')">
                <div class="card-body">
                    <h5 class="card-title">In Progress</h5>
                    <p class="card-text display-4">{{ in_progress_tickets }}</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-danger text-white" onclick="loadTickets('closed')">
                <div class="card-body">
                    <h5 class="card-title">Closed Tickets</h5>
                    <p class="card-text display-4">{{ closed_tickets }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Access Section -->
    <div class="row">
        <div class="col-md-4">
            <div class="card">
                <div class="card-body text-center">
                    <h5 class="card-title">Manage Tickets</h5>
                    <p class="card-text">View, edit, and manage all tickets in the system.</p>
                    <a href="{{ url_for('tickets.list_tickets') }}" class="btn btn-primary">Go to Tickets</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card">
                <div class="card-body text-center">
                    <h5 class="card-title">Create Ticket</h5>
                    <p class="card-text">Add a new ticket to the system.</p>
                    <a href="{{ url_for('tickets.create_ticket') }}" class="btn btn-success">Create Ticket</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card">
                <div class="card-body text-center">
                    <h5 class="card-title">User Management</h5>
                    <p class="card-text">View and manage system users (Admin only).</p>
                    <a href="{{ url_for('admin.manage_users') }}" class="btn btn-warning">Manage Users</a>
                </div>
            </div>
        </div>
    </div>
</div>

 <!-- Tickets Modal -->
<div class="modal fade" id="ticketsModal" tabindex="-1" aria-labelledby="ticketsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ticketsModalLabel">Tickets</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h3 id="tickets-title" class="text-center"></h3>
                <table class="table table-hover table-striped" id="tickets-table">
                    <thead class="table-dark">
                        <tr>
                            <th>#</th>
                            <th>Title</th>
                            <th>Description</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="tickets-body">
                        <!-- Rows will be injected dynamically -->
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/admin_dashboard.js') }}?v=1.0"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
